(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{186:function(t,e,n){"use strict";var r=n(0),i=n.n(r);e.a=function(t){var e=t.formErrors;return i.a.createElement("div",{className:"formErrors"},Object.keys(e).map(function(t,n){return e[t].length>0?i.a.createElement("p",{key:n},t," ",e[t]):""}))}},29:function(t,e,n){"use strict";n.d(e,"a",function(){return m});var r=n(0),i=n.n(r),a=n(2),o=n.n(a),c=n(7),l=n(13);function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(){return(s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e){return!e||"object"!==u(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function m(t){var e=new c.a;return function(n){function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=p(this,h(a).call(this,t))).state={isLoading:!0},e}var c,u,m;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(a,r["Component"]),c=a,(u=[{key:"componentDidMount",value:function(){e.loggedIn()||o.a.push("/admin/login"),this.setState({isLoading:!1})}},{key:"render",value:function(){return i.a.createElement("div",null,this.state.isLoading?i.a.createElement("div",null,i.a.createElement(l.a,null)):i.a.createElement(t,s({},this.props,{auth:e})))}}])&&f(c.prototype,u),m&&f(c,m),a}()}},606:function(t,e,n){__NEXT_REGISTER_PAGE("/admin/film",function(){return t.exports=n(607),{page:t.exports.default}})},607:function(t,e,n){"use strict";n.r(e);var r=n(0),i=n.n(r),a=n(2),o=n.n(a),c=(n(33),n(29)),l=n(78),u=n(9),s=n(14),f=n(186);function p(t){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function m(t,e){return(m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function y(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var v=new l.a,b=function(t){function e(){var t,n,r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,(t=!(r=d(e).call(this))||"object"!==p(r)&&"function"!=typeof r?y(n):r).handleChange=t.handleChange.bind(y(y(t))),t.handleSubmit=t.handleSubmit.bind(y(y(t))),t.state={category:o.a.query.category,title:"",title_pt:"",description:"",description_pt:"",picture:"",is_active:!0,category_id:o.a.query.id,titleValid:!1,titlePtValid:!1,pictureValid:!1,formErrors:{title:"",titulo:"",picture:""},update:!1,filmId:o.a.query.idFilm},t}var n,r,a;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}(e,i.a.Component),n=e,(r=[{key:"handleChange",value:function(t){var e=this,n=this.state.category.toLowerCase(),r=this.state.title.toLowerCase().replace(/[\s-]/g,"-")||"film",i=new FormData;i.append("picture",t[0]),i.append("title",r),i.append("category",n),v.uploadPicture(i).then(function(t){e.setState({picture:t.data}),e.validateField("picture",t.data)})}},{key:"handleInput",value:function(t){var e=this,n=t.target.name,r=t.target.value;this.setState(function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({},n,r),function(){e.validateField(n,r)})}},{key:"componentDidMount",value:function(){var t=this;o.a.query.idFilm&&v.getFilmById(o.a.query.idFilm).then(function(e){t.setState({title:e.title,title_pt:e.title_pt,description:e.description,description_pt:e.description_pt,picture:e.picture,is_active:e.is_active,titleValid:!0,titlePtValid:!0,pictureValid:!0,update:!0}),t.setState({formValid:t.state.titleValid&&t.state.titlePtValid&&t.state.pictureValid})})}},{key:"validateField",value:function(t,e){var n=this.state.formErrors,r=this.state.titleValid,i=this.state.titlePtValid,a=this.state.pictureValid;switch(t){case"title":r=e.length>=3,n.title=r?"":" is too short";break;case"title_pt":i=e.length>=3,n.titulo=i?"":" é muito curto";break;case"picture":a=e.length>=3,n.picture=a?"":": select an image"}this.setState({formErrors:n,titleValid:r,titlePtValid:i,pictureValid:a},this.validateForm)}},{key:"validateForm",value:function(){this.setState({formValid:this.state.titleValid&&this.state.titlePtValid&&this.state.pictureValid})}},{key:"handleSubmit",value:function(t){t.preventDefault();var e=this.state,n=e.title,r=e.title_pt,i=e.description,a=e.description_pt,c=e.is_active,l=e.picture,u=e.category_id,s=e.update,f=e.filmId,p=(e.category,{title:n,title_pt:r,description:i,description_pt:a,is_active:c,picture:l,category_id:u});s?v.updateFilm(p,f).then(function(t){o.a.push("/admin/".concat(t.data.id,"/videos"))}):v.saveFilm(p).then(function(t){o.a.push("/admin/".concat(t.data.id,"/videos"))})}},{key:"nextStep",value:function(){}},{key:"render",value:function(){var t=this,e=this.state,n=e.category,r=e.category_id;return i.a.createElement("section",{className:"admin"},i.a.createElement("header",{className:"header"},i.a.createElement("div",{className:"arrow-back action",onClick:function(){return o.a.push("/admin/".concat(r,"/films/"))}},i.a.createElement("i",{className:"fas fa-arrow-left icon"}),i.a.createElement("small",{className:"text"},"Back")),i.a.createElement(u.a,null)),i.a.createElement("main",{className:"main"},i.a.createElement("h2",{className:"title"},n),i.a.createElement("form",{className:"form -grid",onSubmit:this.handleSubmit},i.a.createElement("div",{className:"col"},i.a.createElement("small",null,"English"),i.a.createElement("input",{type:"text",id:"title",name:"title",className:"input",value:this.state.title,placeholder:"Title*",onChange:function(e){return t.handleInput(e)}}),i.a.createElement("textarea",{placeholder:"Description",id:"description",name:"description",value:this.state.description,className:"textarea",onChange:function(e){return t.handleInput(e)}})),i.a.createElement("div",{className:"col"},i.a.createElement("small",null,"Portuguese"),i.a.createElement("input",{type:"text",id:"titulo",name:"title_pt",className:"input",value:this.state.title_pt,placeholder:"Título*",onChange:function(e){return t.handleInput(e)}}),i.a.createElement("textarea",{placeholder:"Descrição",id:"descricao",name:"description_pt",value:this.state.description_pt,className:"textarea",onChange:function(e){return t.handleInput(e)}})),i.a.createElement("div",{className:"picture"},i.a.createElement("label",{className:"label"},"Picture*"),i.a.createElement("input",{type:"file",id:"picture",name:"picture",className:"input",placeholder:"Picture",onChange:function(e){return t.handleChange(e.target.files)}}),this.state.picture?i.a.createElement("img",{src:this.state.picture}):null,i.a.createElement("small",{className:"required"},"*Required items")),i.a.createElement("button",{className:"button -center ".concat(this.state.formValid?"":"-disabled"),disabled:!this.state.formValid},"Save and Continue")),i.a.createElement(f.a,{formErrors:this.state.formErrors})),i.a.createElement(s.a,null))}}])&&h(n.prototype,r),a&&h(n,a),e}();e.default=Object(c.a)(b)},7:function(t,e,n){"use strict";function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.d(e,"a",function(){return a});var a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.domain="https://janicedavila.com.br/api/v1",this.fetch=this.fetch.bind(this),this.login=this.login.bind(this),this.getProfile=this.getProfile.bind(this)}var e,n,a;return e=t,(n=[{key:"login",value:function(t,e){var n=this;return this.fetch("".concat(this.domain,"/authenticate"),{method:"POST",body:JSON.stringify({email:t,password:e})}).then(function(t){return n.setToken(t.token.token),n.setProfile({idUser:t.idUser,username:t.username}),Promise.resolve(t)})}},{key:"loggedIn",value:function(){return this.getToken()}},{key:"setProfile",value:function(t){localStorage.setItem("profile",JSON.stringify(t))}},{key:"getProfile",value:function(){return localStorage.getItem("profile")?JSON.parse(localStorage.profile):{}}},{key:"setToken",value:function(t){localStorage.setItem("id_token",t)}},{key:"getToken",value:function(){return localStorage.getItem("id_token")}},{key:"logout",value:function(){localStorage.removeItem("id_token"),localStorage.removeItem("profile")}},{key:"_checkStatus",value:function(t){if(t.status>=200&&t.status<300)return t;var e=new Error(t.statusText);throw e.response=t,e}},{key:"fetch",value:function(t){function e(e,n){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t,e){var n={Accept:"application/json","Content-Type":"application/json"};return this.loggedIn()&&(n.Authorization="Bearer "+this.getToken()),fetch(t,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),i.forEach(function(e){r(t,e,n[e])})}return t}({headers:n},e)).then(this._checkStatus).then(function(t){return t.json()})})}])&&i(e.prototype,n),a&&i(e,a),t}()},78:function(t,e,n){"use strict";function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.d(e,"a",function(){return o});var a=new(n(7).a),o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.domain="https://janicedavila.com.br/api/v1",this.fetch=this.fetch.bind(this)}var e,n,o;return e=t,(n=[{key:"getCategories",value:function(){return this.fetch("".concat(this.domain,"/category"),{method:"GET"}).then(function(t){return Promise.resolve(t)})}},{key:"getFilmsByCategoryId",value:function(t){return this.fetch("".concat(this.domain,"/category/").concat(t,"/films"),{method:"GET"}).then(function(t){return Promise.resolve(t)})}},{key:"getFilmById",value:function(t){return this.fetch("".concat(this.domain,"/film/").concat(t),{method:"GET"}).then(function(t){return Promise.resolve(t)})}},{key:"saveFilm",value:function(t){return this.fetch("".concat(this.domain,"/films"),{method:"POST",body:JSON.stringify(t)}).then(function(t){return Promise.resolve(t)})}},{key:"updateFilm",value:function(t,e){return this.fetch("".concat(this.domain,"/films/").concat(e),{method:"PUT",body:JSON.stringify(t)}).then(function(t){return Promise.resolve(t)})}},{key:"deleteFilm",value:function(t){return this.fetch("".concat(this.domain,"/films/").concat(t),{method:"DELETE"}).then(function(t){return Promise.resolve(t)})}},{key:"saveVideo",value:function(t){return this.fetch("".concat(this.domain,"/videos"),{method:"POST",body:JSON.stringify(t)}).then(function(t){return Promise.resolve(t)})}},{key:"deleteVideo",value:function(t){return this.fetch("".concat(this.domain,"/videos/").concat(t),{method:"DELETE"}).then(function(t){return Promise.resolve(t)})}},{key:"uploadPicture",value:function(t){var e={};return a.loggedIn()&&(e.Authorization="Bearer "+localStorage.getItem("id_token")),console.log(t),fetch("".concat(this.domain,"/upload"),{headers:e,method:"POST",body:t}).then(this._checkStatus).then(function(t){return t.json()})}},{key:"_checkStatus",value:function(t){if(t.status>=200&&t.status<300)return t;var e=new Error(t.statusText);throw e.response=t,e}},{key:"fetch",value:function(t){function e(e,n){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t,e){var n={Accept:"application/json","Content-Type":"application/json"};return a.loggedIn()&&(n.Authorization="Bearer "+localStorage.getItem("id_token")),fetch(t,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),i.forEach(function(e){r(t,e,n[e])})}return t}({headers:n},e)).then(this._checkStatus).then(function(t){return t.json()})})}])&&i(e.prototype,n),o&&i(e,o),t}()}},[[606,1,0]]]);